<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Laudos App</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="css/style.css" />
</head>
<body>
  <div class="app-container d-flex flex-column vh-100">
    <header class="app-header p-3 border-bottom shadow-sm">
      <div class="d-flex justify-content-between align-items-center">
        <h1 class="h4 m-0 text-white">Laudos App</h1>
        <div class="header-actions">
          <button id="btn-new" class="btn btn-light">Novo Laudo</button>
          <button id="btn-list" class="btn btn-outline-light">Lista de Laudos</button>
          <button id="btn-manage-doencas" class="btn btn-outline-info ms-2">Gerenciar Doenças</button>
        </div>
      </div>
    </header>

    <main class="app-main flex-grow-1 p-3 p-md-4 overflow-auto">
      <div id="list-view" class="container-fluid">
        <h2 class="mb-4">Laudos Cadastrados</h2>
        <div id="laudos-list" class="row g-3"></div>
      </div>

      <div id="form-view" class="container-fluid" style="display: none;">
        <h2 class="mb-4">Laudo Médico Pericial</h2>
        
        <ul class="nav nav-tabs mb-3" id="laudoTab" role="tablist">
          <li class="nav-item" role="presentation"><button class="nav-link active" data-bs-toggle="tab" data-bs-target="#tab-processo" type="button">Processo</button></li>
          <li class="nav-item" role="presentation"><button class="nav-link" data-bs-toggle="tab" data-bs-target="#tab-paciente" type="button">Reclamante</button></li>
          <li class="nav-item" role="presentation"><button class="nav-link" data-bs-toggle="tab" data-bs-target="#tab-anamnese" type="button">Anamnese</button></li>
          <li class="nav-item" role="presentation"><button class="nav-link" data-bs-toggle="tab" data-bs-target="#tab-conclusao" type="button">Discussão/Conclusão</button></li>
          <li class="nav-item" role="presentation"><button class="nav-link" data-bs-toggle="tab" data-bs-target="#tab-finalizacao" type="button">Finalização</button></li>
        </ul>

        <form id="laudo-form" class="tab-content">
          <div class="tab-pane fade show active" id="tab-processo" role="tabpanel">
            <div class="card card-body"><h5 class="card-title">Dados do Processo</h5><div class="row g-3"><div class="col-md-6"><label for="numero_processo" class="form-label">Número do Processo:</label><input type="text" class="form-control" id="numero_processo" name="numero_processo" required /></div><div class="col-md-6"><label for="vara_trabalho" class="form-label">Vara do Trabalho:</label><input type="text" class="form-control" id="vara_trabalho" name="vara_trabalho"/></div><div class="col-12"><label for="cidade" class="form-label">Cidade da Vara:</label><input type="text" class="form-control" id="cidade" name="cidade"/></div><div class="col-md-6"><label for="reclamante" class="form-label">Reclamante:</label><input type="text" class="form-control" id="reclamante" name="reclamante" required /></div><div class="col-md-6"><label for="reclamada" class="form-label">Reclamada:</label><input type="text" class="form-control" id="reclamada" name="reclamada" /></div></div></div>
          </div>
          <div class="tab-pane fade" id="tab-paciente" role="tabpanel">
            <div class="card card-body mb-3"><h5 class="card-title">Dados Pessoais</h5><div class="row g-3"><div class="col-md-4"><label for="data_nascimento" class="form-label">Data de Nascimento:</label><input type="date" class="form-control" id="data_nascimento" name="data_nascimento" /></div><div class="col-md-2"><label for="idade" class="form-label">Idade:</label><input type="text" class="form-control" id="idade" name="idade" readonly /></div><div class="col-md-3"><label for="cpf" class="form-label">CPF:</label><input type="text" class="form-control" id="cpf" name="cpf" /></div><div class="col-md-3"><label for="naturalidade" class="form-label">Naturalidade:</label><input type="text" class="form-control" id="naturalidade" name="naturalidade" /></div></div></div>
            <div class="card card-body mb-3"><h5 class="card-title">Dados Laborais na Reclamada</h5><div class="row g-3"><div class="col-md-6"><label for="funcao_reclamante" class="form-label">Função:</label><input type="text" class="form-control" id="funcao_reclamante" name="funcao_reclamante" /></div><div class="col-md-3"><label for="data_admissao" class="form-label">Data de Admissão:</label><input type="date" class="form-control" id="data_admissao" name="data_admissao" /></div><div class="col-md-3"><label for="data_demissao" class="form-label">Data de Demissão:</label><input type="date" class="form-control" id="data_demissao" name="data_demissao" /></div></div></div>
            <div class="card card-body"><h5 class="card-title">Exame Físico</h5><div class="row g-3 align-items-end">
                <div class="col-md-3"><label for="altura" class="form-label">Altura (m):</label><input type="text" class="form-control" id="altura" name="altura" /></div>
                <div class="col-md-3"><label for="peso" class="form-label">Peso (kg):</label><input type="text" class="form-control" id="peso" name="peso" /></div>
                <div class="col-md-3"><label for="imc" class="form-label">IMC (kg/m²):</label><input type="text" class="form-control" id="imc" name="imc" readonly /></div>
                <div class="col-12"><label for="exame_fisico_geral" class="form-label">Exame Físico Geral:</label><textarea class="form-control" id="exame_fisico_geral" name="exame_fisico_geral" rows="2"></textarea></div>
                <div class="col-md-6"><label for="tipo-exame-especifico" class="form-label">Modelo de Exame Específico:</label><select id="tipo-exame-especifico" class="form-select"></select></div>
                <div class="col-12"><div id="exames-especificos-container" class="row g-3 mt-1"></div></div>
                <div class="col-12"><label class="form-label">Fotos:</label><div><button type="button" id="btn-add-photo" class="btn btn-outline-secondary btn-sm">Adicionar Fotos</button></div><div id="photos-preview-container" class="photos-preview mt-2 border rounded p-2 d-flex flex-wrap gap-2"></div></div>
            </div></div>
          </div>
          <div class="tab-pane fade" id="tab-anamnese" role="tabpanel">
            <div class="card card-body"><h5 class="card-title">Anamnese e Histórico</h5><div class="row g-3"><div class="col-12"><label for="queixa_principal" class="form-label">Queixa Principal:</label><textarea class="form-control" id="queixa_principal" name="queixa_principal" rows="3"></textarea></div><div class="col-12"><label for="historia_molestia" class="form-label">História Pregressa da Moléstia:</label><textarea class="form-control" id="historia_molestia" name="historia_molestia" rows="8"></textarea></div><div class="col-12"><label class="form-label">Passado Laboral (CTPS):</label><div id="passado-laboral-list" class="dynamic-list-container"></div><button type="button" id="btn-add-passado-laboral" class="btn btn-outline-secondary btn-sm mt-2">Adicionar Experiência</button></div></div></div>
          </div>
          <div class="tab-pane fade" id="tab-conclusao" role="tabpanel">
            <div class="card card-body mb-3"><h5 class="card-title">Análise Técnica</h5><div class="row g-3"><div class="col-12"><label class="form-label">Exames Complementares:</label><div id="exames-list-container" class="dynamic-list-container"></div><button type="button" id="btn-add-exame" class="btn btn-outline-secondary btn-sm mt-2">Adicionar Exame</button></div><div class="col-12"><label for="discussao" class="form-label">Considerações Médicas / Discussão:</label><textarea class="form-control" id="discussao" name="discussao" rows="8"></textarea></div><div class="col-12"><label for="conclusao" class="form-label">Conclusão:</label><textarea class="form-control" id="conclusao" name="conclusao" rows="5"></textarea></div></div></div>
            <div class="card card-body"><h5 class="card-title">Respostas aos Quesitos</h5><div id="quesitos-group-container"></div></div>
          </div>
          <div class="tab-pane fade" id="tab-finalizacao" role="tabpanel">
             <div class="card card-body mb-3"><h5 class="card-title">Dados do Perito e Honorários</h5><div class="row g-3"><div class="col-md-6"><label for="perito" class="form-label">Perito:</label><input type="text" class="form-control" id="perito" name="perito" /></div><div class="col-md-6"><label for="crm" class="form-label">CRM:</label><input type="text" class="form-control" id="crm" name="crm" /></div><div class="col-md-6"><label for="valor_honorarios" class="form-label">Valor de Honorários (R$):</label><input type="text" class="form-control" id="valor_honorarios" name="valor_honorarios" /></div><div class="col-md-6"><label for="valor_por_extenso" class="form-label">Valor por Extenso:</label><input type="text" class="form-control" id="valor_por_extenso" name="valor_por_extenso" /></div></div></div>
            <div class="card card-body"><h5 class="card-title">Datas</h5><div class="row g-3"><div class="col-md-4"><label for="data_pericia" class="form-label">Data da Perícia:</label><input type="date" class="form-control" id="data_pericia" name="data_pericia" /></div><div class="col-md-4"><label for="hora_pericia" class="form-label">Hora da Perícia:</label><input type="time" class="form-control" id="hora_pericia" name="hora_pericia" /></div><div class="col-md-4"><label for="data_laudo" class="form-label">Data do Laudo:</label><input type="date" class="form-control" id="data_laudo" name="data_laudo" /></div></div></div>
          </div>
          
          <div class="form-actions mt-4 text-end">
            <button type="button" id="btn-cancel" class="btn btn-secondary me-2">Cancelar</button>
            <button type="submit" class="btn btn-primary">Salvar Laudo</button>
          </div>
        </form>
      </div>

      <div id="loading-view" class="d-none justify-content-center align-items-center" style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(33, 37, 41, 0.8); z-index: 1100;">
        <div class="spinner-border text-primary" role="status"><span class="visually-hidden">Loading...</span></div>
      </div>
    </main>

    <footer class="app-footer p-3 text-center border-top mt-auto">
      <p class="m-0">Sistema de Laudos Médicos &copy; <span id="year"></span></p>
    </footer>

    <div class="modal fade" id="modal-doencas" tabindex="-1">
      <div class="modal-dialog modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Gerenciar Doenças e Testes</h5>
            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
          </div>
          <div class="modal-body" id="doencas-management-content">
               </div>
        </div>
      </div>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="js/imask.min.js"></script>
  <script src="js/renderer.js"></script>
</body>
</html>